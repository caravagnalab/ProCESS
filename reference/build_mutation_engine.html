<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Create a mutation engine object"><title>Create a mutation engine object — build_mutation_engine • rRACES</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a mutation engine object — build_mutation_engine"><meta property="og:description" content="Create a mutation engine object"><meta property="og:image" content="https://caravagnalab.github.io/rRACES/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rRACES</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/rRACES.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/tissue_simulation.html">Tissue simulation</a>
    <a class="dropdown-item" href="../articles/sampling.html">Tissue sampling</a>
    <a class="dropdown-item" href="../articles/growth_models.html">Growth Models</a>
    <a class="dropdown-item" href="../articles/mutations.html">Simulating Mutations</a>
    <a class="dropdown-item" href="../articles/sequencing.html">Sequencing Simulation</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/caravagnalab/rRACES/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Create a mutation engine object</h1>
      <small class="dont-index">Source: <a href="https://github.com/caravagnalab/rRACESR/RcppExports.R" class="external-link"><code>R/RcppExports.R</code></a></small>
      <div class="d-none name"><code>build_mutation_engine.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Create a mutation engine object</p>
    </div>


    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>setup_code</dt>
<dd><p>The set-up code (alternative to `directory`).</p></dd>


<dt>directory</dt>
<dd><p>The set-up directory (alternative to `setup_code`).</p></dd>


<dt>reference_url</dt>
<dd><p>The reference genome URL (mandatory when `directory`
is provided).</p></dd>


<dt>SBS_url</dt>
<dd><p>The SBS file URL (mandatory when `directory` is provided).</p></dd>


<dt>default_num_of_alleles</dt>
<dd><p>The default number of alleles per chromosome 
(mandatory when `directory` is provided).</p></dd>


<dt>exceptions_on_allele_number</dt>
<dd><p>A list of exceptions for the default 
number of alleles per chromosome (optional when `directory`
in provided).</p></dd>


<dt>context_sampling</dt>
<dd><p>The number of reference contexts per context in the
index (optional: default value is 100).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A mutation engine object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function downloads and sets up the data requires by
      by a mutation engine object and build it.</p>      
<p>There are two building modalities: the first one is more general, 
      but it requires to specify all the data sources; the second one  
      adopts some pre-set configurations, but it is more convient than
      the former in many cases.</p>
<p>The first building modality requires to specify the directory in
      which the data must be saved, the reference sequence URL, the SBS
      file URL, the default number of alleles per chromosome, and, 
      optionally, the exceptions on the number of alleles (e.g., one 
      allele for "X" and "Y" in human genome) through the parameters 
      `directory`, `reference_url`, `SBS_url`, `default_num_of_alleles`,
      and `exceptions_on_allele_number`, respectively.</p>
<p>The second building modality exclusively requires a set-up code 
      (parameter `setup_code`). The list of supported set-up codes can 
      be obtained by using the function `get_mutation_engine_codes`.</p>
<p>The number of context sampling is an optional parameter that allows
      sampling the reference contexts while building the context index.
      This parameter, which is set to 100 by default, specifies how many
      occurences of the same context must be identified before adding 
      one of them to the context index. The larger the number of context
      sampling, the larger the context index. On the other side, the
      lower the number of context sampling, the lower the number of sites
      in the reference genome that can be affected by simulated
      mutations.</p>
<p>If the parameters of a mutation engine construction match those 
      of a previous construction, then the corresponding reference
      sequence, the SBS file, and the previously built context index
      are loaded from the set-up directory avoiding further 
      computations.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>`get_mutation_engine_codes` provides a list of the supported 
        set-up codes.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># set the reference and SBS URLs</span></span></span>
<span class="r-in"><span><span class="va">reference_url</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"https://ftp.ensembl.org/pub/release-110/fasta/"</span>,</span></span>
<span class="r-in"><span>                        <span class="st">"homo_sapiens/dna/Homo_sapiens.GRCh38.dna."</span>,</span></span>
<span class="r-in"><span>                        <span class="st">"chromosome.22.fa.gz"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sbs_url</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"https://cancer.sanger.ac.uk/signatures/documents/2124/"</span>,</span></span>
<span class="r-in"><span>                  <span class="st">"COSMIC_v3.4_SBS_GRCh38.txt"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># build a mutation engine and save the required files into the</span></span></span>
<span class="r-in"><span><span class="co"># directory "Test"</span></span></span>
<span class="r-in"><span><span class="va">m_engine</span> <span class="op">&lt;-</span> <span class="fu">build_mutation_engine</span><span class="op">(</span>directory <span class="op">=</span> <span class="st">"Test"</span>,</span></span>
<span class="r-in"><span>                                  reference_url <span class="op">=</span> <span class="va">reference_url</span>,</span></span>
<span class="r-in"><span>                                  SBS_url <span class="op">=</span> <span class="va">sbs_url</span>,</span></span>
<span class="r-in"><span>                                  default_num_of_alleles <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Downloading reference genome...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reference genome downloaded</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Decompressing reference file...done</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Downloading SBS file...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SBS file downloaded</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Building context index...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> done</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># if the parameters of a mutation engine construction match those of a</span></span></span>
<span class="r-in"><span><span class="co"># previous construction, then the corresponding reference sequence,</span></span></span>
<span class="r-in"><span><span class="co"># the SBS file, and the previously built context index are loaded from</span></span></span>
<span class="r-in"><span><span class="co"># the set-up directory avoiding further computations.</span></span></span>
<span class="r-in"><span><span class="va">m_engine</span> <span class="op">&lt;-</span> <span class="fu">build_mutation_engine</span><span class="op">(</span><span class="st">"Test"</span>, <span class="va">reference_url</span>, <span class="va">sbs_url</span>,</span></span>
<span class="r-in"><span>                                  default_num_of_alleles <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># if the `context_sampling` parameter changes, a new context index is</span></span></span>
<span class="r-in"><span><span class="co"># built, while neither the reference sequence nor the SBS file are </span></span></span>
<span class="r-in"><span><span class="co"># downloaded again.</span></span></span>
<span class="r-in"><span><span class="va">m_engine</span> <span class="op">&lt;-</span> <span class="fu">build_mutation_engine</span><span class="op">(</span><span class="st">"Test"</span>, <span class="va">reference_url</span>, <span class="va">sbs_url</span>,</span></span>
<span class="r-in"><span>                                  default_num_of_alleles <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                                  context_sampling <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Building context index...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> done</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># a futher contruction with the same parameters avoids both downloads</span></span></span>
<span class="r-in"><span><span class="co"># and context index construction.</span></span></span>
<span class="r-in"><span><span class="va">m_engine</span> <span class="op">&lt;-</span> <span class="fu">build_mutation_engine</span><span class="op">(</span><span class="st">"Test"</span>, <span class="va">reference_url</span>, <span class="va">sbs_url</span>,</span></span>
<span class="r-in"><span>                                  default_num_of_alleles <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                                  context_sampling <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the parameters `directory`, `reference_url`, and `SBS_url` can be</span></span></span>
<span class="r-in"><span><span class="co"># avoided by providing the `setup_code` parameter. The set-up code </span></span></span>
<span class="r-in"><span><span class="co"># `demo` is provided among those available for testing purpose.</span></span></span>
<span class="r-in"><span><span class="va">m_engine</span> <span class="op">&lt;-</span> <span class="fu">build_mutation_engine</span><span class="op">(</span>setup_code <span class="op">=</span> <span class="st">"demo"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the `context_sampling` can be used also when a pre-defined set-up</span></span></span>
<span class="r-in"><span><span class="co"># configuration is adopted.</span></span></span>
<span class="r-in"><span><span class="va">m_engine</span> <span class="op">&lt;-</span> <span class="fu">build_mutation_engine</span><span class="op">(</span>setup_code <span class="op">=</span> <span class="st">"demo"</span>,</span></span>
<span class="r-in"><span>                                  context_sampling <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Building context index...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> done</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># remove the "Test" and "demo" directories</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"Test"</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"demo"</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Giulio Caravagna, Alberto Casagrande.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

