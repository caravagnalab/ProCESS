<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Adding an exposure to the mutation engine — MutationEngine$add_exposure • ProCESS</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Adding an exposure to the mutation engine — MutationEngine$add_exposure"><meta name="description" content="This method adds an exposure to the mutation engine."><meta property="og:description" content="This method adds an exposure to the mutation engine."><meta property="og:image" content="https://caravagnalab.github.io/ProCESS/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ProCESS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/ProCESS.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/tissue_simulation.html">Tissue simulation</a></li>
    <li><a class="dropdown-item" href="../articles/sampling.html">Tissue sampling</a></li>
    <li><a class="dropdown-item" href="../articles/mutations.html">Simulating Mutations</a></li>
    <li><a class="dropdown-item" href="../articles/sequencing.html">Sequencing Simulation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/caravagnalab/ProCESS/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Adding an exposure to the mutation engine</h1>
      <small class="dont-index">Source: <a href="https://github.com/caravagnalab/ProCESS/R/RcppExports.R" class="external-link"><code>R/RcppExports.R</code></a></small>
      <div class="d-none name"><code>MutationEngine-cash-add_exposure.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This method adds an exposure to the mutation engine.</p>
    </div>


    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>The simulated time at which the exposure is adopted
(optional).</p></dd>


<dt id="arg-exposure">exposure<a class="anchor" aria-label="anchor" href="#arg-exposure"></a></dt>
<dd><p>An exposure for the specified mutation type, i.e.,
a discrete probability distribution over a set of signature.
The indel and SNV exposures can be specified in the same list.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The exposure will be used to establish the probability
for a passenger mutation to occur depending on its context.</p>
<p>Each exposure is associated to a time that is the simulated
time in which the set is adopted.
If a time is provided the exposure is used from the specified
time on up to the successive exposure change. When an exposure
is added to the mutation engine without specifying the time,
its time is 0.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># create a demonstrative mutation engine</span></span></span>
<span class="r-in"><span><span class="va">m_engine</span> <span class="op">&lt;-</span> <span class="fu"><a href="MutationEngine.html">MutationEngine</a></span><span class="op">(</span>setup_code <span class="op">=</span> <span class="st">"demo"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Downloading reference genome...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reference genome downloaded</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Decompressing reference file...done</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Downloading signature files...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signature file downloaded</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Downloading driver mutation file...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Driver mutation file downloaded</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Downloading passenger CNAs file...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Passenger CNAs file downloaded</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Downloading germline mutations...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Germline mutations downloaded</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Building context index...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [█---------------------------------------] 0% [00m:00s] Processing chr. 22                         [███████---------------------------------] 16% [00m:01s] Processing chr. 22                        [█████████████████-----------------------] 40% [00m:02s] Processing chr. 22                        [███████████████████████████-------------] 65% [00m:03s] Processing chr. 22                        [█████████████████████████████████-------] 81% [00m:04s] Processing chr. 22                        [████████████████████████████████████████] 100% [00m:06s] Context index built                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [█---------------------------------------] 0% [00m:00s] Saving context index                       [████████████████████████████████████████] 100% [00m:00s] Context index saved                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> done</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Building repeated sequence index...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [█---------------------------------------] 0% [00m:00s] Processing chr. 22                         [█---------------------------------------] 0% [00m:00s] Processing chr. 22                         [█---------------------------------------] 0% [00m:05s] Processing chr. 22                         [█---------------------------------------] 0% [00m:07s] Processing chr. 22                         [█---------------------------------------] 0% [00m:08s] Processing chr. 22                         [█---------------------------------------] 0% [00m:11s] Processing chr. 22                         [█---------------------------------------] 0% [00m:13s] Processing chr. 22                         [█---------------------------------------] 0% [00m:19s] Processing chr. 22                         [████████████████████████████████████████] 100% [00m:19s] RS index built                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [█---------------------------------------] 0% [00m:00s] Saving RS index                            [█---------------------------------------] 0% [00m:01s] Saving RS index                            [█---------------------------------------] 0% [00m:02s] Saving RS index                            [██████████████████████------------------] 52% [00m:03s] Saving RS index                          done</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [████████████████████████████████████████] 100% [00m:03s] RS index saved                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [█---------------------------------------] 0% [00m:00s] Loading germline                           [████████████████████████████████████████] 100% [00m:00s] Germline loaded                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [█---------------------------------------] 0% [00m:00s] Saving germline                            [████████████████████████████████████████] 100% [00m:00s] Germline saved                          </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># add a default set of coefficients that will be used from simulated</span></span></span>
<span class="r-in"><span><span class="co"># time 0 up to the successive coefficient change. The indel and SNV</span></span></span>
<span class="r-in"><span><span class="co"># exposures can be specified in the same list.</span></span></span>
<span class="r-in"><span><span class="va">m_engine</span><span class="op">$</span><span class="fu">add_exposure</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>SBS13 <span class="op">=</span> <span class="fl">0.3</span>, SBS1 <span class="op">=</span> <span class="fl">0.7</span>, ID2 <span class="op">=</span> <span class="fl">0.2</span>, ID3 <span class="op">=</span> <span class="fl">0.3</span>,</span></span>
<span class="r-in"><span>                        ID20 <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># add a default set of coefficients that will be used from simulated</span></span></span>
<span class="r-in"><span><span class="co"># time 3.2 up to the end of the simulation.</span></span></span>
<span class="r-in"><span><span class="va">m_engine</span><span class="op">$</span><span class="fu">add_exposure</span><span class="op">(</span><span class="fl">3.2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>SBS5 <span class="op">=</span> <span class="fl">0.3</span>, SBS2 <span class="op">=</span> <span class="fl">0.2</span>, SBS3 <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m_engine</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MutationEngine</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Passenger rates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Driver mutations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Timed Exposure</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    SBS Timed Exposures</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [0, 3.2[: {"SBS1": 0.7, "SBS13": 0.3}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [3.2, ∞[: {"SBS2": 0.2, "SBS3": 0.5, "SBS5": 0.3}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    indel Timed Exposures</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [0, ∞[: {"ID2": 0.2, "ID20": 0.5, "ID3": 0.3}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alberto Casagrande, Giulio Caravagna.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

