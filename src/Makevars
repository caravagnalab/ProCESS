#PKG_LIBS = `$(R_HOME)/bin/Rscript -e \ "RcppClassic:::LdFlags()"` 

BUILD_DIR =     ../_builds
INSTALL_DIR =   ../_install

PKG_LIBS += -L$(INSTALL_DIR)/lib/ -lRACES

PKG_CXXFLAGS += -I$(INSTALL_DIR)/include/

all: 	libRACES

libRACES:   
	cmake -H../RACES/ -B$(BUILD_DIR) \
	-DCMAKE_BUILD_TYPE=Release \
	-DCMAKE_INSTALL_PREFIX=$(INSTALL_DIR) \
	-DBUILD_ONLY_LIBRARIES:bool=true \
	-DUSE_OPTIONAL_LIBS:bool=false \
	-DBUILD_SHARED_LIBS:bool=false

	cmake --build $(BUILD_DIR) --target install --config Release

        cp $(INSTALL_DIR)/lib/RACES.a $(INSTALL_DIR)/lib/libRACES.so || echo "Failed: RACES.a -> src"

.PHONY: all clean libRACES

clean:
	rm -f $(OBJECTS) $(SHLIB) $(BUILD_DIR)

