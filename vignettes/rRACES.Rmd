---
title: "rRACES"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{rRACES}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## Using `rRACES`

rRACES is at early stage of development and misses many features of 
RACES. At the moment, it supports:
- creating a spacial simulation
- adding species to the simulation
- adding cells to the spacial simulation
- running a simulation up to a specified simulated time

Further classes and methods will be available soon.

## A Small Example

```{r, eval=FALSE}
require(rRACES)

# Create a new simulation and set the simulation data directory
# to be "output_dir". A 1000x1000-cells tissue is automatically
# added to the simulation
sim <- new(Simulation, "output_dir")

# Get the simulation directory, i.e., "output_dir"
sim$get_directory()

# Get the tissue size, i.e., c(1000,1000)
sim$get_tissue_size()

# Set the tissue name and size
sim$set_tissue("Liver", 1200, 900)

# Get the tissue name, i.e., "Liver"
sim$get_tissue_name()

# Get the tissue size, i.e., c(1200,900)
sim$get_tissue_size()

# Add two species, "A" and "B", having epigenetic states
sim$add_species(name = "A",
                epigenetic_rates = c("+-" = 0.01, "-+" = 0.01),
                growth_rates = c("+" = 0.2, "-" = 0.08),
                death_rates = c("+" = 0.1, "-" = 0.01))

sim$add_species(name = "B",
                epigenetic_rates = c("+-" = 0.01, "-+" = 0.01),
                growth_rates = c("+" = 0.1, "-" = 0.3),
                death_rates = c("+" = 0.05, "-" = 0.1))


# Program a timed transition from species "A" to
# species "B" at time 30
sim$add_timed_mutation("A", "B", 60)

# Get the simulation species with epigenetic state names
sim$get_species_names()

# Add one cell to the simulated tissue
sim$add_cell(genotype_name = "A+", x = 500, y = 500)

# Run the simulation up until the there are less than 100 
# cells in the species B-
sim$run_up_to_size("B-", 100)

# Get the number of fired event per species 
sim$get_firings()

# Run the simulation up until number of deaths in B-
# is at least 100
sim$run_up_to_event("death", "B", "-", 100)

# Get the number of fired event per species. The row
# "death", "B", "-" reports 100 firings
sim$get_firings()

# Get simulation time
sim$get_clock()

# Report the number of cells per species at the current simulation time, e.g.,
#   species epistate counts
# 1       A        -  30942
# 2       A        + 105715
# 3       B        -    100
# 4       B        +   1371
sim$get_counts()

# Run the simulation up to time 110
sim$run_up_to_time(110)

# Get simulation time, i.e., 110
sim$get_clock()

# Get the cells in the tissue at current simulation time
sim$get_cells()

# Get the cells in the tissue rectangular sample having [500,500]
# and [505,505] as lower and upper corners, respectively
sim$get_cells(c(500, 500), c(505, 505))

# Get the cells in the tissue having epigenetic state "-"
sim$get_cells(c("A", "B"), c("-"))

# Get the cells in the tissue having epigenetic state "-" and, at
# the same time, belonging to rectangular sample bounded by [500,500]
# and [505,505] as lower and upper corners, respectively
sim$get_cells(c(500, 500), c(505, 505), c("A", "B"), c("-"))
```

At the end of the computation, the directory `output_dir` will contain 
simulated data usable by RACES. 
